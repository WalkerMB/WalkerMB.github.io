<!DOCTYPE html>
<html lang="en">
  <head>
    <style type="text/css">
      body {
        background: #3d3d3d;
        font-family: "Courier";
        letter-spacing: 3px;
      }
      #butt {
        color: white;
        font-size: 50px;
      }
      #gameboard {
        color: #3d3d3d;
        background: #3d3d3d;
      }
      #drift {
      }
      #winner {
        color: yellow;
        font-size: 100px
      }
      .not-won {
        display: none;
      }
      
    </style>
    <script defer>
      
      // Creating gameboard vars
      var haswon = false
      var gameboard = [];
      var counter = 0;

      // Creating spawn
      var firstrow = 0;
      var firstcolumn = 0;

      // Creating player
      var player = {
        row: firstrow,
        column: firstcolumn,
      };

      // Making gameboard
      // Frist loop is the hight
      while (counter < 24) {
        var templist = [];
        var hack = 0;
        
        // 2nd loop is lenght + creating game boards tiles, monster, monster movment
        while (hack < 29) {
          var temp = {};
          temp.tile = "<>";
          temp.monster = false;
          temp.direction = "left";
          templist.push(temp);
          hack += 1;
        }
        counter++;
        gameboard.push(templist);
      }

      // puting down walls
      gameboard[0][6].tile = "‚¨ú";
      gameboard[2][6].tile = "‚¨ú";
      gameboard[3][6].tile = "‚¨ú";
      gameboard[4][6].tile = "‚¨ú";
      gameboard[5][6].tile = "‚¨ú";
      gameboard[5][5].tile = "‚¨ú";
      gameboard[5][4].tile = "‚¨ú";
      gameboard[5][3].tile = "‚¨ú";
      gameboard[5][1].tile = "‚¨ú";
      gameboard[5][0].tile = "‚¨ú";

      gameboard[8][3].tile = "‚¨ú";
      gameboard[9][3].tile = "‚¨ú";
      gameboard[10][3].tile = "‚¨ú";
      gameboard[11][3].tile = "‚¨ú";
      gameboard[10][4].tile = "‚¨ú";
      gameboard[11][4].tile = "‚¨ú";
      gameboard[11][5].tile = "‚¨ú";
      gameboard[11][6].tile = "‚¨ú";

      gameboard[8][0].tile = "‚¨ú";
      gameboard[9][0].tile = "‚¨ú";
      gameboard[10][0].tile = "‚¨ú";
      gameboard[11][0].tile = "‚¨ú";
      gameboard[12][0].tile = "‚¨ú";
      gameboard[13][0].tile = "‚¨ú";
      gameboard[14][0].tile = "‚¨ú";
      gameboard[14][1].tile = "‚¨ú";
      gameboard[14][2].tile = "‚¨ú";
      gameboard[14][3].tile = "‚¨ú";
      gameboard[14][4].tile = "‚¨ú";
      gameboard[14][5].tile = "‚¨ú";
      gameboard[14][6].tile = "‚¨ú";

      gameboard[16][6].tile = "‚¨ú";
      gameboard[16][5].tile = "‚¨ú";
      gameboard[16][4].tile = "‚¨ú";
      gameboard[16][3].tile = "‚¨ú";
      gameboard[16][2].tile = "‚¨ú";
      gameboard[17][2].tile = "‚¨ú";
      gameboard[18][2].tile = "‚¨ú";
      gameboard[19][2].tile = "‚¨ú";
      gameboard[20][2].tile = "‚¨ú";
      gameboard[21][2].tile = "‚¨ú";
      gameboard[22][3].tile = "‚¨ú";
      gameboard[22][4].tile = "‚¨ú";
      gameboard[22][6].tile = "‚¨ú";
      gameboard[22][5].tile = "‚¨ú";
      gameboard[16][7].tile = "‚¨ú";

      gameboard[18][6].tile = "‚¨ú";
      gameboard[19][6].tile = "‚¨ú";
      gameboard[19][5].tile = "‚¨ú";
      gameboard[20][6].tile = "‚¨ú";

      gameboard[1][14].tile = "‚¨ú";
      gameboard[2][14].tile = "‚¨ú";
      gameboard[3][14].tile = "‚¨ú";
      gameboard[3][13].tile = "‚¨ú";
      gameboard[3][12].tile = "‚¨ú";
      gameboard[3][11].tile = "‚¨ú";
      gameboard[3][10].tile = "‚¨ú";
      gameboard[3][9].tile = "‚¨ú";
      gameboard[4][11].tile = "‚¨ú";
      gameboard[5][11].tile = "‚¨ú";
      gameboard[6][11].tile = "‚¨ú";
      gameboard[6][12].tile = "‚¨ú";

      gameboard[9][9].tile = "‚¨ú";
      gameboard[10][9].tile = "‚¨ú";
      gameboard[11][9].tile = "‚¨ú";
      gameboard[11][10].tile = "‚¨ú";
      gameboard[11][11].tile = "‚¨ú";
      gameboard[11][12].tile = "‚¨ú";
      gameboard[12][12].tile = "‚¨ú";
      gameboard[13][12].tile = "‚¨ú";
      gameboard[14][12].tile = "‚¨ú";
      gameboard[15][12].tile = "‚¨ú";

      gameboard[7][8].tile = "‚¨ú";

      gameboard[23][9].tile = "‚¨ú";
      gameboard[22][9].tile = "‚¨ú";
      gameboard[22][10].tile = "‚¨ú";
      gameboard[21][10].tile = "‚¨ú";
      gameboard[21][11].tile = "‚¨ú";
      gameboard[20][11].tile = "‚¨ú";

      gameboard[20][13].tile = "‚¨ú";
      gameboard[20][14].tile = "‚¨ú";
      gameboard[21][14].tile = "‚¨ú";
      gameboard[21][15].tile = "‚¨ú";
      gameboard[22][15].tile = "‚¨ú";

      gameboard[12][17].tile = "‚¨ú";
      gameboard[13][17].tile = "‚¨ú";
      gameboard[14][17].tile = "‚¨ú";
      gameboard[16][17].tile = "‚¨ú";
      gameboard[15][17].tile = "‚¨ú";

      gameboard[5][17].tile = "‚¨ú";
      gameboard[5][18].tile = "‚¨ú";
      gameboard[6][17].tile = "‚¨ú";
      gameboard[6][18].tile = "‚¨ú";

      gameboard[2][19].tile = "‚¨ú";
      gameboard[2][20].tile = "‚¨ú";
      gameboard[3][20].tile = "‚¨ú";
      gameboard[3][19].tile = "‚¨ú";

      gameboard[8][16].tile = "‚¨ú";
      gameboard[8][17].tile = "‚¨ú";
      gameboard[8][18].tile = "‚¨ú";
      gameboard[8][19].tile = "‚¨ú";
      gameboard[8][20].tile = "‚¨ú";
      gameboard[8][21].tile = "‚¨ú";
      gameboard[8][22].tile = "‚¨ú";
      gameboard[8][14].tile = "‚¨ú";
      gameboard[8][15].tile = "‚¨ú";

      gameboard[11][20].tile = "‚¨ú";
      gameboard[11][21].tile = "‚¨ú";
      gameboard[11][22].tile = "‚¨ú";
      gameboard[11][23].tile = "‚¨ú";
      gameboard[11][24].tile = "‚¨ú";
      gameboard[12][24].tile = "‚¨ú";
      gameboard[13][24].tile = "‚¨ú";
      gameboard[16][24].tile = "‚¨ú";
      gameboard[14][24].tile = "‚¨ú";
      gameboard[15][24].tile = "‚¨ú";

      gameboard[16][20].tile = "‚¨ú";
      gameboard[16][21].tile = "‚¨ú";

      gameboard[19][16].tile = "‚¨ú";
      gameboard[19][21].tile = "‚¨ú";
      gameboard[19][22].tile = "‚¨ú";
      gameboard[19][23].tile = "‚¨ú";
      gameboard[19][17].tile = "‚¨ú";
      gameboard[19][18].tile = "‚¨ú";
      gameboard[19][19].tile = "‚¨ú";
      gameboard[19][20].tile = "‚¨ú";
      gameboard[19][24].tile = "‚¨ú";
      gameboard[19][25].tile = "‚¨ú";

      gameboard[2][28].tile = "‚¨ú";
      gameboard[2][27].tile = "‚¨ú";
      gameboard[3][27].tile = "‚¨ú";
      gameboard[4][27].tile = "‚¨ú";
      gameboard[5][27].tile = "‚¨ú";
      gameboard[5][26].tile = "‚¨ú";
      gameboard[5][25].tile = "‚¨ú";

      gameboard[16][28].tile = "‚¨ú";
      gameboard[16][27].tile = "‚¨ú";
      gameboard[15][26].tile = "‚¨ú";
      gameboard[15][27].tile = "‚¨ú";
      gameboard[15][28].tile = "‚¨ú";

      gameboard[20][28].tile = "‚¨ú";
      gameboard[19][28].tile = "‚¨ú";
      gameboard[18][28].tile = "‚¨ú";
      gameboard[17][28].tile = "‚¨ú";

      gameboard[22][28].tile = "‚¨ú";
      //gameboard[22][27].tile = "‚¨ú";
      gameboard[22][26].tile = "‚¨ú";
      gameboard[21][28].tile = "‚¨ú";
      // gameboard[21][27].tile = "‚¨ú";

      // winning tile
      gameboard[23][28].tile = "üèÜ";
      gameboard[23][25].tile = "‚¨ú";
      gameboard[23][24].tile = "‚¨ú";
      gameboard[23][23].tile = "‚¨ú";
      //gameboard[23][27].tile = "‚¨ú";
      gameboard[23][26].tile = "‚¨ú";

      // placing monsters
      gameboard[1][17].monster = true;
      gameboard[9][14].monster = true;
      gameboard[7][20].monster = true;
      gameboard[6][8].monster = true;
      gameboard[1][2].monster = true;
      gameboard[14][7].monster = true;
      gameboard[17][10].monster = true;
      gameboard[18][9].monster = true;
      gameboard[23][20].monster = true;
      gameboard[21][12].monster = true;
      gameboard[21][16].monster = true;
      gameboard[9][1].monster = true;
      gameboard[3][15].monster = true;
      gameboard[5][24].monster = true;

      // function to render gameboard
      function render() {
        var index = 0;
        var newcode = "";
        while (index < gameboard.length) {
          var row = "<div>";
          var inner_index = 0;
          var temp = gameboard[index];
          while (inner_index < temp.length) {
            var tile = temp[inner_index].tile;
            if (index == player.row && inner_index == player.column) {
              row += "üöò";
            } else if (temp[inner_index].monster) {
              row += "üöî";
            } else {
              row += tile;
            }
            inner_index += 1;
          }
          row += "</div>";
          newcode += row;
          index += 1;
        }
        document.getElementById("gameboard").innerHTML = newcode;
      }
      window.addEventListener("DOMContentLoaded", function () {
        render();
      });

      // function to move monster and kill the player
      function movemonster() {
        var rowcounter = 0;
        while (rowcounter < gameboard.length) {
          var columnlist = gameboard[rowcounter];
          var columncounter = 0;
          var justmoved = false;
          while (columncounter < columnlist.length) {
            
            // 
            if (columnlist[columncounter].monster) {
              
              // monster is moing left
              if (columnlist[columncounter].direction == "left") {
                
                // monster
                if (
                  columncounter != 0 &&
                  columnlist[columncounter - 1].tile == "<>"
                ) {
                  console.log("test");
                  gameboard[rowcounter][columncounter].monster = false;
                  gameboard[rowcounter][columncounter - 1].monster = true;

                  // check if monster moved into player square. kill if true
                  if (
                    rowcounter == player.row &&
                    columncounter - 1 == player.column
                  ) {
                    player.column = firstcolumn;
                    player.row = firstrow;
                  }
                }

                // monster is at left edge of the board or at wall
                else if (
                  columncounter == 0 ||
                  columnlist[columncounter - 1].tile == "‚¨ú"
                ) {
                  gameboard[rowcounter][columncounter].direction = "right";

                  // check if player moves into monster then kill üòà
                  if (
                    rowcounter == player.row &&
                    columncounter == player.column
                  ) {
                    player.row = firstrow;
                    player.column = firstcolumn;
                  }
                }
                
                // monster is moving right
              } else if (columnlist[columncounter].direction == "right") {
                
                // checking monster is not at the right edge and no wall to teh right
                if (
                  columncounter != columnlist.length - 1 &&
                  columnlist[columncounter + 1].tile == "<>" &&
                  justmoved == false
                ) {
                  gameboard[rowcounter][columncounter].monster = false;
                  gameboard[rowcounter][columncounter].direction = "left";

                  gameboard[rowcounter][columncounter + 1].monster = true;
                  gameboard[rowcounter][columncounter + 1].direction = "right";

                  // check if monster moved into player square kill if true + set monster to just moved 
                  if (
                    rowcounter == player.row &&
                    columncounter + 1 == player.column
                  ) {
                    player.column = firstcolumn;
                    player.row = firstrow;
                  }

                  justmoved = true;
                  
                  // set the monster back to not moved
                } else if (justmoved) {
                  justmoved = false;
                }

                // monster is not at the right side or an obstical is to the right
                else if (
                  columncounter == columnlist.length - 1 ||
                  columnlist[columncounter + 1].tile == "‚¨ú"
                ) {
                  
                  // monster is at the right edge or a wall is to the right
                  gameboard[rowcounter][columncounter].direction = "left";

                  // if the player moves into the monster kill the player
                  if (
                    rowcounter == player.row &&
                    columncounter == player.column
                  ) {
                    player.row = firstrow;
                    player.column = firstcolumn;
                  }
                }
              }
            }
            columncounter += 1;
          }
          rowcounter += 1;
        }
      }

      // function to move the player + execute all functions + after win stuff
      function keypress(e) {
        
        // player win freeze them 
        if (haswon == true){
          return;
        }
        
        // arrow left move the player left unless it is at the edge or next to a wall then execute functions
        if (
          e.key == "ArrowLeft" &&
          player.column > 0 &&
          gameboard[player.row][player.column - 1].tile != "‚¨ú"
        ) {
          player.column -= 1;
          movemonster();
          render();
        }
        
        // arrow right move the player right unless it is at the edge or next to a wall then execute functions
        if (
          e.key == "ArrowRight" &&
          player.column < 28 &&
          gameboard[player.row][player.column + 1].tile != "‚¨ú"
        ) {
          player.column += 1;
          movemonster();
          render();
        }
        
        // arrow up move the player up unless it is at the edge or next to a wall then execute functions
        if (
          e.key == "ArrowUp" &&
          player.row != 0 &&
          gameboard[player.row - 1][player.column].tile != "‚¨ú"
        ) {
          player.row -= 1;
          movemonster();
          render();
        }
        
        // arrow down move the player down unless it is at the edge or next to a wall then execute functions
        if (
          e.key == "ArrowDown" &&
          player.row != 23 &&
          gameboard[player.row + 1][player.column].tile != "‚¨ú"
        ) {
          player.row += 1;
          movemonster();
          render();
        }
        
        // if player is at the winning tile display winning message
        if (gameboard[player.row][player.column].tile == "üèÜ"){
          haswon = true
          
          document.getElementById("winner").classList.remove('not-won')
        }
      }

      window.addEventListener("keydown", keypress);
    </script>
  </head>
  <body>
    <h1 id="butt">GTA:But Shit-E-er</h1>

    <audio controls autoplay="true">
      <source
        src="https://cdn.glitch.me/b496d1d5-2846-4bda-9f1a-0201c9b89a7f/1_HOUR_OF_PHONK_DRIFT_MUSIC_COWBELL.mp3?v=1649187870863"
      />
      Your browser does not support the audio element.
    </audio>

    <div id="gameboard"></div>
    
    <div id="winner" class="not-won">
    Winner Winner Chicken Dinner!
    </div>
    
  </body>
</html>
